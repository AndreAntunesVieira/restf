"use strict";function cors(e,r){return function(s,t,o){var n=parseHosts(e),i=getOrigin(s.headers);if(0===n.length||!i)return setCors(t,"*"),o();var l=i.replace(/http(s)?:\/\//,"");return n.includes(l)?(setCors(t,i,r),"OPTIONS"!==s.method?o():t.send()):(t.status(403),t.send())}}function parseHosts(e){return Array.isArray(e)?e:"string"==typeof e?e.replace(/\s/g,"").split(","):[]}function getOrigin(e){return e.origin||""}function setCors(e,r,s){void 0===s&&(s="*"),e.setHeader("Access-Control-Allow-Headers",s),e.setHeader("Access-Control-Allow-Methods","GET,POST,DELETE,PUT,OPTIONS,HEADERS"),e.setHeader("Access-Control-Allow-Origin",r),e.setHeader("Access-Control-Allow-Credentials","true")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=cors;